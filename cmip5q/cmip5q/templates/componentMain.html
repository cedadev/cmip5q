{% extends "twopanel.html" %}

{% block titlerow %}
<table><tr>
<td><h1> Model {%if not c.isModel%} {% if c.isRealm %}Realm {% else %}Component{% endif%} {%endif%} {{c.abbrev }} (status {{c.status}})</h1> </td> 
    {% if c.controlled %} 
    {% else %}
    <td>
        <form action="{{urls.form}}" method="POST">&nbsp;&nbsp;
            <input type="hidden" name="deleteMe" value="1"/>
            <input id="deleteButton" type="submit" value="Delete"/>
        </form>
    </td>
    {% endif %}
    </tr></table>
{% endblock %}

{% block leftcolumn %}
    <div class="boxer">
        <p class="red"> All buttons and links above and in this column navigate away from this page. Save your work first!</p></div>
        <div class="boxer"><h4> Available Models </h4><div id="treeDiv"> {{navtree|safe}}</div>
        <h4>Component {{c.abbrev}}</h4>
        <p class="guidance"> Please add details of any other relevant
        subcomponents of this component <p>
        <p><form action="{{urls.subcomp}}" method="POST">
            <input id="sublinkbut" type="submit" name="CreateSub" value="Add Subcomponent"/></form></p>
    </div>
    <div class="boxer"> 
    <p> The button(s) in this box navigate to pages which further describe this <b>component</b>.</p>
        {% if not isModel %}<p><a id="inplinkbut" href="{{urls.inputs}}">Inputs Needed</a></p>{% endif %}
        <p><a id="reflinkbut" href="{{urls.refs}}"> References</a></p>
    </div>
    <div class="boxer">
        <p> The buttons in this box navigate to pages for this <b>model</b>.</p>
        <p><a id="cuplinkbut" href="{{urls.coupling}}"> Resolve Inputs</a></p> 
        <p><a id="txtlinkbut" href="{{urls.text}}">Export Text</a></p>
        {% include 'docbuttons.html' %}
    </div>
{% endblock %}

{% block mainpanel %}
    <div class="boxer2">
    <form action="{{urls.form}}" method='post'>
        <div class="boxer">    
            <table>
                <tr><td class="inputH1">Short Name:&nbsp;{{cform.abbrev.errors}}</td>
                <td colspan="3">
                  {{cform.abbrev}}&nbsp;(type:&nbsp;{{cform.scienceType}}{{cform.viewableScienceType}})
                </td></tr>
                {% if cform.showImplemented %}
                {% if not isModel %} <tr><td>Implemented:&nbsp;{{cform.implemented.errors}}</td>
                <td colspan="3">{{cform.implemented}} Untick the box if there is no representation of {{cform.instance.scienceType}} in your model.</td></tr> {% endif %}
                {% endif %}
                <tr><td>Long Name:&nbsp;{{cform.title.errors}}</td><td colspan="3">{{cform.title}}</td></tr> 
                <tr><td>Responsible Parties</td><td colspan="3">(Use the parties tab to add more choices here): </td></tr>
                <tr><td></td><td>Contact:&nbsp;{{cform.contact.errors}}{{cform.contact}}</td>
                             <td>Lead Author:&nbsp;{{cform.author.errors}}{{cform.author}}</td>
                             <td>Funder:&nbsp;{{cform.funder.errors}}{{cform.funder}}</td>
                			 <td><input checked="checked" type="checkbox" name="gen-implemented" id="id_gen-implemented" /> Tick to copy 'Responsible Party' downwards.</td>
                </tr>
                
            </table>
            <!-- Following is hidden -->
            {{cform.controlled}} 
        </div>
        {% if isRealm or isModel %}
        <div class="boxer">
        <h4>Genealogy</h4>
        <p>Year First  Released:&nbsp;{{cform.yearReleased.errors}}{{cform.yearReleased}}</p>
        <p class="guidance"> The year first released applies to the version you are describing in this questionnaire. If this version is a substantial upgrade to a previous version, please provide the name of that previous version and some key scientific details of the upgrade.</p>
        <center>
        <p> Previous Version (name):&nbsp;{{cform.otherVersion.errors}}{{cform.otherVersion}} </p>
        <p class="guidance">Please tell us how this component has been improved from that previous version. </p>
        <p>{{cform.geneology.errors}}{{cform.geneology}}</p>
            </center>
        </div>
        {% endif %}
        <div class="boxer">
        <h4> Component Attributes </h4>
            <p> In this section enter parameters and attributes associated with this 
            {% if c.isModel %} model {% endif %}{% if c.isRealm %} realm {% endif %}
            {% if not c.isModel %} component {% endif %}.</p>
            <!--include 'component_attributes.html' -->
            {% include 'newcomponent_attributes.html' %}
        </div>
       
        <div class="boxer"> 
            <h4> Additional Information</h4>
            <center>
            <p class="guidance">If you have chosen "other" in an attribute description above, please 
            provide details of that "other" here.</p>
            <p> Please also provide any other information that will help the interpretation of simulations using this component. </p>
            <p>{{cform.description}}</p> 
            </center> 
        </div>
        <center><input id="updateButton1" type="submit" value="Save"/>
        </center>
    </form>
    </div><!-- boxer2 div -->
    
    {% if inps|length %}
    <div class="boxer">
        <h4> Inputs required by this component are: </h4>
        <table>
        <tr><th> Type </th><th> Short Name </th><th>Description </th></tr>
        {% for i in inps %}
        <tr class="{%cycle  'row2' 'row1'%}">
        <td>{{i.ctype}}</td><td>{{i.abbrev}}</td><td>{{i.description}}</td><tr>
        {% endfor %} 
        </table>
        <p class="guidance"> Update this list using the "Inputs Needed" button </p>
        {% if isRealm %}
        <p> It is possible that the components below this "realm" do not provide a sensible place to
        put all the scientifically important inputs which might be required by this realm. If so, please describe them here!</p>
        {% endif %}   
    </div>
    {% endif %}
    
    <div class="boxer">
        <h4> References (associated with this component) </h4>
        {% if refs|length_is:0 %} 
        <p class="guidance"> No references are yet associated with this component. Use the reference button to add references</p>
        {% else %}
        <p class="guidance"> Update this list using the reference button.</p>
        <table width="100%" class="backgrey">
            <tr><th> Citation</th><th>Source</th></tr>
            {% for r in refs%}
            <tr><td >{{r.citation}}</td><td width="10%">(<a href="{{r.link}}">link</a>)</td></tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>
    
    {% if isModel %}
    <div class="boxer">
        <h4> Required Inputs and Couplings </h4>
        <table>
        {% for bc in cset %}
        <tr class="{%cycle  'row2' 'row1'%}"><td>{{bc.targetInput.ctype}}</td><td>{{bc}} uses {{bc.internalclosure_set.all|length}} internal link(s) and {{bc.externalclosure_set.all|length}} file link(s) by default.</tr>
        {% endfor %}
        </table>
    </div>
    {% endif %}


<!-- button specific javascript follows -->
<script  type="text/javascript"> 
        var oLinkButton3 = new YAHOO.widget.Button("reflinkbut"); 
        var oLinkButton6 = new YAHOO.widget.Button("cuplinkbut"); 
        var olinkButton7 = new YAHOO.widget.Button("txtlinkbut");
        var oLinkButton8 = new YAHOO.widget.Button("inplinkbut"); 
        var oLinkButton4 = new YAHOO.widget.Button("sublinkbut",{value:"sublinkbutValue"}); 
        var oSubmitButton1 = new YAHOO.widget.Button("updateButton1",{value:"updateButton1value"}); 
        var deleteButton1 = new YAHOO.widget.Button("deleteButton",{value:"deleteButtonvalue"}); 
</script>
<!-- end of button javascript -->

<!-- YUI treeview stuff for body -->
<script type="text/javascript">

//create our own namespace object
YAHOO.namespace("protoq.tree");
	                 
//define the initTree function
YAHOO.protoq.tree.initTree = function() {

    //create a TreeView object
    var tree = new YAHOO.widget.TreeView("treeDiv");

    //Fix for non-activation of href link on single-clicking node label (YUI bug?):
    //Subscribe to the "dblClickEvent" and do nothing.
    tree.subscribe("dblClickEvent", function(node) {
    }); 

	// Draw the tree
    tree.draw();
  
};
 
 //Add an onDOMReady handler to build the tree when the document is ready
YAHOO.util.Event.onDOMReady(YAHOO.protoq.tree.initTree);
 
</script>
<!-- End of YUI treeview stuff for body -->

{% endblock %}